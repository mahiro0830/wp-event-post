{"version":3,"file":"main.js","mappings":"u/CAaA,iBAKE,WAAmBA,G,MACjBC,KAAKD,QAAUA,GAAW,KAC1BC,KAAKC,WAAaF,EAAQG,iBAAiB,sBAAwB,GACnEF,KAAKG,aAAeJ,EAAQG,iBAAiB,aAAe,GAC5DF,KAAKI,YAAcL,EAAQM,cAAc,aAAe,KACxDL,KAAKM,aAAeP,EAAQM,cAAc,cAAgB,KAC1DL,KAAKO,KAAO,GACZP,KAAKQ,MAAQ,GACbR,KAAKS,SAAyC,QAA/B,EAAAV,EAAQW,QAAQ,uBAAe,eAAEC,aAAa,mBAAoB,GACjFX,KAAKY,SAAU,EACfZ,KAAKa,eAAiBC,SAAST,cAAc,gBAAkB,IACjE,CAmGF,OA1FS,YAAAU,KAAP,SAAYR,EAAiCC,QAAjC,IAAAD,IAAAA,GAAO,IAAIS,MAAOC,oBAAe,IAAAT,IAAAA,GAAQ,IAAIQ,MAAOE,WAAa,GAC3ElB,KAAKO,KAAOA,EACZP,KAAKQ,MAAQA,EACbR,KAAKmB,aAAanB,KAAKO,KAAMP,KAAKQ,MACpC,EAQO,YAAAW,aAAP,SAAoBZ,EAAmCC,GAAvD,gBAAoB,IAAAD,IAAAA,EAAwBP,KAAKO,WAAM,IAAAC,IAAAA,EAAyBR,KAAKQ,OAEnFR,KAAKY,SAAU,EACXZ,KAAKa,iBAAgBb,KAAKa,eAAeO,MAAMC,QAAU,SAE3DrB,KAAKO,KAAOe,OAAOf,GACnBP,KAAKQ,MAAQc,OAAOd,GAGpB,IAAMe,EAA+D,IAApD,IAAIP,KAAKhB,KAAKO,KAAMP,KAAKQ,MAAQ,EAAG,GAAGgB,SAAiB,EAAI,IAAIR,KAAKhB,KAAKO,KAAMP,KAAKQ,MAAQ,EAAG,GAAGgB,SAAW,EAEzHC,EAAW,IAAIT,KAAKhB,KAAKO,KAAMP,KAAKQ,MAAO,GAAGkB,UAEhD1B,KAAKI,cAAaJ,KAAKI,YAAYuB,YAAcC,OAAO5B,KAAKO,OAC7DP,KAAKM,eAAcN,KAAKM,aAAaqB,YAAcC,OAAO5B,KAAKQ,QAG/DR,KAAKG,aAAa0B,QACpB7B,KAAKG,aAAa2B,SAAQ,SAACC,EAA0BC,GAG/C,IAKMC,EAPNF,IACEC,EAAQT,GAAYS,GAASP,EAAWF,GACpCU,EAAaF,EAAK1B,cAAc,WAEpC4B,EAAWN,YAAc,KAGrBM,EAAaF,EAAK1B,cAAc,WAEpC4B,EAAWN,YAAcC,OAAOI,EAAQT,EAAW,IAI3D,IAIFvB,KAAKG,aAAa2B,SAAQ,SAACC,GACzB,IAAMG,EAAQH,aAAI,EAAJA,EAAM1B,cAAc,UAClC6B,SAAAA,EAAOC,QACT,IAGenC,KAAKoC,YAAYpC,KAAKO,KAAMP,KAAKQ,OACzC6B,MAAK,SAACC,GACXA,EAAKR,SAAQ,SAACS,GACZ,IACMC,EADO,IAAIxB,KAAKuB,EAAKE,WAAWC,aACrBhB,UACXiB,EAAa,EAAKxC,aAAaqC,EAAMjB,EAAW,GACtD,GAAIoB,EAAY,CAEd,IAAMC,EAAe9B,SAAS+B,cAAc,OAC5CD,EAAaE,UAAUC,IAAI,SAC3BH,EAAajB,YAAcY,EAAKS,MAAMC,SACtCN,EAAWO,YAAYN,EACzB,CACF,IAGA,EAAKhC,SAAU,EACX,EAAKC,iBAAgB,EAAKA,eAAeO,MAAMC,QAAU,OAC/D,GACJ,EAQc,YAAAe,YAAd,SAA0B7B,EAAuBC,G,gGAE5B,O,sBAAA,GAAM2C,MAAM,UAAGnD,KAAKS,QAAO,8BAAsBF,EAAI,YAAIC,K,OAC7D,SADI,SACW4C,Q,OAC5B,MAAO,CAAP,EADa,U,yBAGbC,QAAQC,MAAM,G,+BAGpB,EAnHA,GAqHA,UAAeC,C,2JClIf,gBAEAzC,SAAS0C,iBAAiB,oBAAoB,WAC5C,IAAMC,EAAiD3C,SAASZ,iBAAiB,iBAAmB,GAC9FwD,EAAmC5C,SAAST,cAAc,aAAe,KACzEsD,EAAmC7C,SAAST,cAAc,aAAe,KAC3EuD,EAAmC,GAEvC,GAAIH,EAAiB5B,OAArB,CAKA,IAAIgC,EAAgB,EACpBJ,EAAiB3B,SAAQ,SAAC/B,GACxB,GAAKA,EAGL,GAFA8D,IACAD,EAAeC,GAAS,IAAI,UAAe9D,GAC7B,IAAV8D,EACFD,EAAeC,GAAO9C,WACjB,CAGL,IAAM+C,EAA2BF,EAAeC,EAAQ,GAAGtD,KACrDwD,EAA4BH,EAAeC,EAAQ,GAAGrD,MAGtDwD,EAA8B1C,OAAOyC,GAAY,IAAO,GAAK,EAAIzC,OAAOyC,GAAY,EACpFE,EAA8B3C,OAAOyC,GAAY,IAAO,GAAMzC,OAAOwC,GAAW,EAAIxC,OAAOwC,GAG3FI,EAAa5C,OAAOyC,GAAY,GAAO,EAAI,GAAKzC,OAAOyC,GAAY,EACnEI,EAAa7C,OAAOyC,GAAY,GAAO,EAAKzC,OAAOwC,GAAW,EAAIxC,OAAOwC,GAG3EJ,IACFA,EAAaU,QAAQD,SAAWvC,OAAOuC,GACvCT,EAAaU,QAAQF,UAAYtC,OAAOsC,IAGtCP,IACFA,EAAaS,QAAQH,SAAWrC,OAAOqC,GACvCN,EAAaS,QAAQJ,UAAYpC,OAAOoC,IAG1CJ,EAAeC,GAAO9C,KAAKkD,EAAUD,EACvC,CACF,IAEIN,GAAiBC,IAIrBD,EAAaF,iBAAiB,SAAS,SAACa,GAEtC,IAAMF,EAAW7C,OAAOoC,EAAa/C,aAAa,mBAC5CuD,EAAY5C,OAAOoC,EAAa/C,aAAa,oBAG7CqD,EAAaE,EAAY,IAAO,GAAK,EAAIA,EAAY,EACrDD,EAAaC,EAAY,IAAO,GAAMC,EAAW,EAAIA,EAGrDG,EAAcJ,EAAY,GAAO,EAAI,GAAKA,EAAY,EACtDK,EAAcL,EAAY,GAAO,EAAKC,EAAW,EAAIA,EAGtDT,GAAiBC,IACtBD,EAAaU,QAAQD,SAAWvC,OAAO2C,GACvCb,EAAaU,QAAQF,UAAYtC,OAAO0C,GACxCX,EAAaS,QAAQH,SAAWrC,OAAOqC,GACvCN,EAAaS,QAAQJ,UAAYpC,OAAOoC,GAGxCJ,EAAe,GAAGzC,aAAayC,EAAe,GAAGrD,KAAMqD,EAAe,GAAGpD,OACzEoD,EAAe,GAAGzC,aAAagD,EAAUD,GAC3C,IAKAP,EAAaH,iBAAiB,SAAS,SAACa,GAEtC,IAAMJ,EAAW3C,OAAOqC,EAAahD,aAAa,mBAC5CqD,EAAY1C,OAAOqC,EAAahD,aAAa,oBAG7CuD,EAAaF,EAAY,GAAO,EAAI,GAAKA,EAAY,EACrDG,EAAaH,EAAY,GAAO,EAAKC,EAAW,EAAIA,EAGpDO,EAAcR,EAAY,IAAO,GAAMC,EAAW,EAAIA,EACtDQ,EAAcT,EAAY,IAAO,GAAK,EAAIA,EAAY,EAGvDN,GAAiBC,IACtBA,EAAaS,QAAQH,SAAWrC,OAAO4C,GACvCb,EAAaS,QAAQJ,UAAYpC,OAAO6C,GACxCf,EAAaU,QAAQD,SAAWvC,OAAOuC,GACvCT,EAAaU,QAAQF,UAAYtC,OAAOsC,GAGxCN,EAAe,GAAGzC,aAAaqD,EAAWC,GAC1Cb,EAAe,GAAGzC,aAAa8C,EAAUD,GAC3C,IAhGmC,CAiGrC,G,GCxGIU,EAA2B,CAAC,GAGhC,SAASC,EAAoBC,GAE5B,IAAIC,EAAeH,EAAyBE,GAC5C,QAAqBE,IAAjBD,EACH,OAAOA,EAAaE,QAGrB,IAAIC,EAASN,EAAyBE,GAAY,CAGjDG,QAAS,CAAC,GAOX,OAHAE,EAAoBL,GAAUM,KAAKF,EAAOD,QAASC,EAAQA,EAAOD,QAASJ,GAGpEK,EAAOD,OACf,CCnB0BJ,CAAoB,I","sources":["webpack://wp-event-post/./src/ts/_CalendarDrawer.ts","webpack://wp-event-post/./src/ts/main.ts","webpack://wp-event-post/webpack/bootstrap","webpack://wp-event-post/webpack/startup"],"sourcesContent":["interface Calendar {\n  element: HTMLElement | null;\n  dateElemts: NodeListOf<HTMLElement> | [];\n  cellElements: NodeListOf<HTMLElement> | [];\n  yearDisplay: HTMLElement | null;\n  monthDisplay: HTMLElement | null;\n  year: string | number;\n  month: string | number;\n  apiPath: string;\n  loading: boolean;\n  loadingElement: HTMLElement | null;\n}\n\nclass Calendar {\n  /**\n   * constructor\n   * @param { HTMLElement } element\n   */\n  public constructor(element: HTMLElement) {\n    this.element = element || null;\n    this.dateElemts = element.querySelectorAll('.p-calendar__date') || [];\n    this.cellElements = element.querySelectorAll('.js-cell') || [];\n    this.yearDisplay = element.querySelector('.js-year') || null;\n    this.monthDisplay = element.querySelector('.js-month') || null;\n    this.year = '';\n    this.month = '';\n    this.apiPath = element.closest('#mc-calendar')?.getAttribute('data-api-path') || '';\n    this.loading = false;\n    this.loadingElement = document.querySelector('.js-loading') || null;\n  };\n\n  /**\n   * 初期化\n   * カレンダーの描画\n   * @param { number } 年\n   * @param { number } 月\n   * @return { void }\n   */\n  public init(year = new Date().getFullYear(), month = new Date().getMonth() + 1): void {\n    this.year = year;\n    this.month = month;\n    this.drawCalendar(this.year, this.month);\n  };\n\n  /**\n   * カレンダーを描画\n   * @param { number } 年\n   * @param { number } 月\n   * @return { void }\n   */\n  public drawCalendar(year: string | number = this.year, month: string | number = this.month): void {\n    // ローディングを表示\n    this.loading = true;\n    if (this.loadingElement) this.loadingElement.style.display = 'block';\n\n      this.year = Number(year);\n      this.month = Number(month);\n\n      // 月初めの曜日を取得\n      const firstDay = new Date(this.year, this.month - 1, 1).getDay() === 0 ? 6 : new Date(this.year, this.month - 1, 1).getDay() - 1;\n      // 月末の日付を取得\n      const lastDate = new Date(this.year, this.month, 0).getDate();\n\n      if (this.yearDisplay) this.yearDisplay.textContent = String(this.year);\n      if (this.monthDisplay) this.monthDisplay.textContent = String(this.month);\n\n      // 日付を描画\n      if (this.cellElements.length) {\n        this.cellElements.forEach((cell: HTMLElement | null, index: number) => {\n          if (cell) {\n            if (index < firstDay || index >= lastDate + firstDay) {\n              const dayElement = cell.querySelector('.day');\n              if (dayElement) {\n                dayElement.textContent = '';\n              }\n            } else {\n              const dayElement = cell.querySelector('.day');\n              if (dayElement) {\n                dayElement.textContent = String(index - firstDay + 1);\n              }\n            }\n          }\n        });\n      }\n\n      // イベントをリフレッシュ\n      this.cellElements.forEach((cell: HTMLElement | null) => {\n        const event = cell?.querySelector('.event');\n        event?.remove();\n      });\n\n      // イベントを描画\n      const events = this.fetchEvents(this.year, this.month);\n      events.then((data) => {\n        data.forEach((item: any) => {\n          const date = new Date(item.event_meta.event_start);\n          const day = date.getDate();\n          const targetCell = this.cellElements[day + firstDay - 1];\n          if (targetCell) {\n            // イベント要素を生成\n            const eventElement = document.createElement('div');\n            eventElement.classList.add('event');\n            eventElement.textContent = item.title.rendered;\n            targetCell.appendChild(eventElement);\n          }\n        });\n\n        // ローディングを非表示\n        this.loading = false;\n        if (this.loadingElement) this.loadingElement.style.display = 'none';\n      });\n  };\n\n  /**\n   * WordPress REST APIからイベントを取得\n   *\n   * @param { string | number } year\n   * @param { string | number } month\n   */\n  private async fetchEvents(year: string | number, month: string | number) {\n    try {\n      const response = await fetch(`${this.apiPath}?event_start_month=${year}-${month}`);\n      const data = await response.json();\n      return data;\n    } catch (error) {\n      console.error(error);\n    }\n  }\n}\n\nexport default Calendar;\n","import CalendarDrawer from './_CalendarDrawer';\n\ndocument.addEventListener('DOMContentLoaded', (): void => {\n  const calendarElements: NodeListOf<HTMLElement> | [] = document.querySelectorAll('.js-calendar') || [];\n  const calendarPrev: HTMLElement | null = document.querySelector('.js-prev') || null;\n  const calendarNext: HTMLElement | null = document.querySelector('.js-next') || null;\n  let calendarDrawer: CalendarDrawer[] = [];\n\n  if(!calendarElements.length) return;\n  /**\n   * CalendarDrawerクラスをインスタンス化\n   * カレンダーを描画する\n   */\n  let count: number = 0;\n  calendarElements.forEach((element: HTMLElement | null) => {\n    if (!element) return;\n    count++;\n    calendarDrawer[count] = new CalendarDrawer(element);\n    if (count === 1) {\n      calendarDrawer[count].init();\n    } else {\n      // 2つ目以降のカレンダーは次の年月をセットして描画\n      // 現在の年月を取得\n      const nowYear: string | number = calendarDrawer[count - 1].year;\n      const nowMonth: string | number = calendarDrawer[count - 1].month;\n\n      // 次の年月を取得\n      const nextMonth: string | number = (Number(nowMonth) + 1) === 13 ? 1 : Number(nowMonth) + 1;\n      const nextYear: string | number = ((Number(nowMonth) + 1) === 13) ? Number(nowYear) + 1 : Number(nowYear);\n\n      // 前の年月を取得\n      const prevMonth = (Number(nowMonth) - 1) === 0 ? 12 : Number(nowMonth) - 1;\n      const prevYear = ((Number(nowMonth) - 1) === 0) ? Number(nowYear) - 1 : Number(nowYear);\n\n      // [data-prev-year][data-prev-month]に値をセット\n      if (calendarPrev) {\n        calendarPrev.dataset.prevYear = String(prevYear);\n        calendarPrev.dataset.prevMonth = String(prevMonth);\n      }\n      // [data-next-year][data-next-month]に値をセット\n      if (calendarNext) {\n        calendarNext.dataset.nextYear = String(nextYear);\n        calendarNext.dataset.nextMonth = String(nextMonth);\n      }\n\n      calendarDrawer[count].init(nextYear, nextMonth);\n    }\n  });\n\n  if(!calendarPrev || !calendarNext) return;\n  /**\n   * 前のカレンダーを表示\n   */\n  calendarPrev.addEventListener('click', (e) => {\n    // 前の年月を取得\n    const prevYear = Number(calendarPrev.getAttribute('data-prev-year'));\n    const prevMonth = Number(calendarPrev.getAttribute('data-prev-month'));\n\n    // 次の年月を取得\n    const nextMonth = (prevMonth + 1) === 13 ? 1 : prevMonth + 1;\n    const nextYear = ((prevMonth + 1) === 13) ? prevYear + 1 : prevYear;\n\n    // 前前の年月を取得\n    const prev2Month = (prevMonth - 1) === 0 ? 12 : prevMonth - 1;\n    const prev2Year = ((prevMonth - 1) === 0) ? prevYear - 1 : prevYear;\n\n    // dataを更新\n    if (!calendarPrev || !calendarNext) return\n    calendarPrev.dataset.prevYear = String(prev2Year);\n    calendarPrev.dataset.prevMonth = String(prev2Month);\n    calendarNext.dataset.nextYear = String(nextYear);\n    calendarNext.dataset.nextMonth = String(nextMonth);\n\n    // カレンダーを描画\n    calendarDrawer[2].drawCalendar(calendarDrawer[1].year, calendarDrawer[1].month);\n    calendarDrawer[1].drawCalendar(prevYear, prevMonth);\n  });\n\n  /**\n   * 次のカレンダーを表示\n   */\n  calendarNext.addEventListener('click', (e) => {\n    // 次の年月を取得\n    const nextYear = Number(calendarNext.getAttribute('data-next-year'));\n    const nextMonth = Number(calendarNext.getAttribute('data-next-month'));\n\n    // 前の年月を取得\n    const prevMonth = (nextMonth - 1) === 0 ? 12 : nextMonth - 1;\n    const prevYear = ((nextMonth - 1) === 0) ? nextYear - 1 : nextYear;\n\n    // 次次の年月を取得\n    const next2Year = ((nextMonth + 1) === 13) ? nextYear + 1 : nextYear;\n    const next2Month = (nextMonth + 1) === 13 ? 1 : nextMonth + 1;\n\n    // dataを更新\n    if (!calendarPrev || !calendarNext) return\n    calendarNext.dataset.nextYear = String(next2Year);\n    calendarNext.dataset.nextMonth = String(next2Month);\n    calendarPrev.dataset.prevYear = String(prevYear);\n    calendarPrev.dataset.prevMonth = String(prevMonth);\n\n    // カレンダーを描画\n    calendarDrawer[2].drawCalendar(next2Year, next2Month);\n    calendarDrawer[1].drawCalendar(nextYear, nextMonth);\n  });\n});\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n","// startup\n// Load entry module and return exports\n// This entry module is referenced by other modules so it can't be inlined\nvar __webpack_exports__ = __webpack_require__(931);\n"],"names":["element","this","dateElemts","querySelectorAll","cellElements","yearDisplay","querySelector","monthDisplay","year","month","apiPath","closest","getAttribute","loading","loadingElement","document","init","Date","getFullYear","getMonth","drawCalendar","style","display","Number","firstDay","getDay","lastDate","getDate","textContent","String","length","forEach","cell","index","dayElement","event","remove","fetchEvents","then","data","item","day","event_meta","event_start","targetCell","eventElement","createElement","classList","add","title","rendered","appendChild","fetch","json","console","error","Calendar","addEventListener","calendarElements","calendarPrev","calendarNext","calendarDrawer","count","nowYear","nowMonth","nextMonth","nextYear","prevMonth","prevYear","dataset","e","prev2Month","prev2Year","next2Year","next2Month","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","undefined","exports","module","__webpack_modules__","call"],"sourceRoot":""}